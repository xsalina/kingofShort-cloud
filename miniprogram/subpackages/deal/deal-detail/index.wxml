<view class="container" >
  <view class="card status-card">
    <view class="row-between">
        <view>
            <view class="stock-title">{{detailInfo.stockName}}</view>
            <view class="text-sub">{{detailInfo.code}}</view>
        </view>
        <view class="badge badge-{{detailInfo.status}} font-lg">
            {{detailText}}
        </view>
    </view>
  </view>

  <view class="section-title">买入信息</view>
  <view class="card info-card">
    <view class="info-grid">
      <view class="info-item">
        <text class="label">买入价格</text>
        <text class="value">{{detailInfo.currency}}{{detailInfo.price}}</text>
      </view>
      <view class="info-item">
        <text class="label">买入数量</text>
        <text class="value">{{detailInfo.quantity}}</text>
      </view>
      <view class="info-item">
        <text class="label">买入手续费</text>
        <text class="value">{{detailInfo.currency}}{{detailInfo.fee}}</text>
      </view>
      <view class="info-item">
        <text class="label">总成本</text>
        <text class="value font-bold">{{detailInfo.currency}}{{buyTotalMoney}}</text>
      </view>
      <view class="info-item full-width">
        <text class="label">买入时间</text>
        <text class="value">{{detailInfo.buyTimeText}}</text>
      </view>
    </view>
  </view>

  <block wx:if="{{detailInfo.status != 'unSold' && detailInfo.sellRecords.length}}">
    <view class="section-title">卖出/收益记录 (最近一次)</view>
    <view class="card info-card sell-theme">
        <view class="info-grid">
        <view class="info-item">
            <text class="label">卖出价格</text>
            <text class="value">{{detailInfo.sellRecords[0].sellPrice}}</text>
        </view>
        <view class="info-item">
            <text class="label">卖出数量</text>
            <text class="value">{{detailInfo.sellRecords[0].sellQuantity}}</text>
        </view>
        <view class="info-item">
          <text class="label">卖出手续费</text>
          <text class="value">{{detailInfo.currency}}{{detailInfo.sellRecords[0].sellFee || 0}}</text>
        </view>
        <view class="info-item">
          <text class="label">卖出时间</text>
          <text class="value font-sm">{{detailInfo.sellRecords[0].sellTimeText}}</text>
        </view>
        <view class="info-item full-width">
            <text class="label">累计实现收益</text>
            <view class="value font-xl {{detailInfo.totalProfit>=0?'text-primary':'text-warn'}}">
                {{detailInfo.totalProfit >=0 ? '+' : ''}}{{detailInfo.currency}}{{detailInfo.totalProfitText}}
            </view>
        </view>
        </view>
    </view>
  </block>

  <view class="card tips-card row-between">
    <view>
        <text class="text-sub display-block mb-10">剩余持仓</text>
        <text class="font-xl font-bold">{{detailInfo.remainingQuantity}} <text class="font-sm">股</text></text>
    </view>
    <view class="text-right">
        <text class="text-sub display-block mb-10">成本均价(单股)</text>
        <text class="font-lg">{{detailInfo.currency}} {{detailInfo.avgCost}}</text>
    </view>
  </view>

  <view class="footer-action" wx:if="{{detailInfo.status === 'unSold' || detailInfo.status === 'partial'}}">
    <button class="btn-sell" bindtap="openSell">卖出操作</button>
  </view>
</view>

<sell-modal 
  show="{{showSellModal}}" 
  tx="{{detailInfo}}"
  bind:close="handleCancel" 
  bind:confirm="handleSell"
/>
<coin-effect 
  show="{{showCoinEffect}}" 
  amount="{{profitAmount}}" 
  bind:finish="onEffectFinish" 
/>